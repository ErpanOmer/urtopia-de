{{ 'jobrad.scss.css' | asset_url | stylesheet_tag }}

<div class="jobrad">
        <div class="banner">
            <div class="centeral-content">
                <div>
                    <img class="pcHide"
                        style="max-width:unset;"
                        src="https://cdn.shopify.com/s/files/1/0633/2068/6808/files/20230427-102927.png?v=1682562584"
                        alt="">
                    <span class="u48DemiBold_v2">Mein Dienstrad – <br> lease company e-bikes <br class="mobileHide">from Urtopia</span>
                    <span class="u24Medium_v2">Orders via Mein Dienstrad also benefit from our labour day promotion: 4 free accessories. The discount will be deducted at checkout. You will receive the accessories separately. Act quickly!</span>
                    <a class="my-button mobileHide" href="#forms">Request on Offer</a>
                    <a class="my-button my-button-black pcHide" href="#forms">Request on Offer</a>
                </div>
                <div class="mobileHide">
                    <img style="width:400px;" src="https://cdn.shopify.com/s/files/1/0633/2068/6808/files/logo_meinstdienstrad_2021_2x_28080504-990b-4bac-ada7-6a7aa2b89188.png?v=1682562347" alt="">
                </div>
            </div>
        </div>
        <div class="benefits">
            <div class="centeral-content">
                <img class="pcHide"
                    src="https://cdn.shopify.com/s/files/1/0633/2068/6808/files/20221010-untitled-7287_a0b456dd-7aa8-41ca-a851-4f590a0428c3.jpg?v=1679973968"
                    alt="">
                <div>
                    <span class="u48DemiBold">Your benefits through Mein Dienstrad</span>
                    <div>
                        <div class="u24Medium">Deducted from your salary</div>
                        <div class="u17Light">Monthly contributions towards your lease of a Urtopia will be deducted from your gross salary.  A 36 month leasing plan let you split the cost and enjoy the product.</div>
                    </div>
                    <div>
                        <div class="u24Medium">Additional monthly savings</div>
                        <div class="u17Light">If you lease with Mein-dienstrad, your purchase is tax deductible. You can save up to
                            40% compared to buying a bike with a traditional payment method.</div>
                    </div>
                    <div>
                        <div class="u24Medium">Enjoy it from now, even outside of work</div>
                        <div class="u17Light">Ride away from stress and towards happiness! Request your bike today to take
                            advantage of an enjoyable biking experience both during work hours as well as after.</div>
                    </div>
                    <a class="my-button my-button-black" href="#forms">Request on Offer</a>
                </div>
                <img class="mobileHide"
                    src="https://cdn.shopify.com/s/files/1/0633/2068/6808/files/20221010-untitled-7287.jpg?v=1679971555"
                    alt="">
            </div>
        </div>
        <div class="works">
            <div class="centeral-content">
                <img class="mobileHide"
                    src="https://cdn.shopify.com/s/files/1/0633/2068/6808/files/20221018-untitled-8667.jpg?v=1679975453"
                    alt="">
                <img class="pcHide"
                    src="https://cdn.shopify.com/s/files/1/0633/2068/6808/files/20221018-untitled-8667_332b211b-8db4-41ab-b50f-049eba8c2038.jpg?v=1679981771"
                    alt="">
                <div>
                    <div class="u48DemiBold">How it works</div>
                    <div class="u20Medium">Please ensure that your employer has signed up with Mein Dienstrad.  <!--<a class="your" style="text-decoration: underline;" href="">Your employer doesn't offer JobRad yet?</a>--></div>
                    <div class="u17Light">
                        1. Click on the button or filling the form below to start your application with a new form. (Currently only Carbon 1 is available for Mein Dienstrad)<br><br>
                        2. We will then place an offer for you on the Mein Dienstrad portal: www.mein-dienstrad.de, where you can view the status of your order, save and manage important documents.<br><br>
                        3. Mein Dienstrad will confirm the order with your employer.<br><br>
                        4. Once it’s been approved by your employer, your bike will then be shipped once in stock.<br><br>
                        5. Please be aware that accessories will be shipped separately and might arrive later than the bike.</div>
                    <a class="my-button my-button-black" style="margin-right: 15px;" href="#forms">Request on Offer</a>
                    <a class="my-button my-button-white" href="/pages/contactus">Contact us</a>
                </div>
            </div>
        </div>
        <!--<div class="calculator">
            <div class="centeral-content jobrad-bike-leasing-calculator"
                id="jobrad-fachhandel-werbematerial-werkzeugkasten-iframe-main">
                <div class="u48DemiBold">JobRad Calculator</div>
                <iframe scrolling="no" width="100%" src="https://bike-leasing-calculator.jobrad.org?genericObserve=true"></iframe>
            </div>
        </div>-->
        <div class="forms" id="forms">
            <div class="centeral-content">
                <div class="u48DemiBold">Join the Ride Today</div>
              <!--<div class="u24Medium" style="font: 300 17px/19px urbane;">Complete the form and we’ll submit the request with your leasing partner. <br>Orders through JobRad also benefit from our Easter promotion: 300 euros and free accessories(bike stand, fenders, water bottle holder). The discount will be deducted at checkout. <br><span class="u20Medium">(Ends on 25th of April)</span></div>-->
                <div class="u24Medium">Complete the form and we’ll submit the request with your leasing partner.</div>
                <form action="" method="post">
                    <div class="item">
                        <div class="mini-item">
                            <div>
                                <div class="u24Medium">First name<i>*</i></div>
                                <input type="text" name="first_name" required>
                            </div>
                            <div>
                                <div class="u24Medium">Last name<i>*</i></div>
                                <input type="text" name="last_name" required>
                            </div>
                        </div>
                    </div>
                    <div class="item">
                        <div class="u24Medium">Email<i>*</i></div>
                        <input type="email" name="email" required>
                    </div>
                    <div class="item">
                        <div class="u24Medium">Phone number<i>*</i></div>
                        <input type="tel" name="phone" required>
                    </div>
                    <div class="item">
                        <div class="u24Medium">Employer<i>*</i></div>
                        <input type="text" name="employer" required>
                    </div>
                    <div class="item">
                        <div class="u24Medium">Delivery address<i>*</i></div>
                        <input type="text" name="address" required>
                    </div>
                    <div class="item">
                        <div class="mini-item">
                            <div>
                                <div class="u24Medium">Postal code<i>*</i></div>
                                <input type="text" name="postal_code" required>
                            </div>
                            <div>
                                <div class="u24Medium">City<i>*</i></div>
                                <input type="text" name="city" required>
                            </div>
                        </div>
                    </div>
                    <div class="item">
                        <div class="u24Medium">Country<i>*</i></div>
                        <input type="text" name="country" value="Deutschland" disabled required>
                    </div>
                    <div class="item">
                        <div class="u24Medium">Bike Model<i>*</i></div>
                        <input type="text" name="bike_model" value="Carbon 1" disabled required>
                    </div>
                    <div class="item">
                        <div class="mini-item">
                            <div>
                                <div class="u24Medium">Bike Size<i>*</i></div>
                                <select name="bike_size" required>
                                    <option value="">---</option>
                                    <option value="M">M - Fit for 170-185 cm</option>                  
                                    <option value="L">L - Fit for 180-195 cm</option>
                                </select>
                            </div>
                            <div>
                                <div class="u24Medium">Bike Style<i>*</i></div>
                                <select name="bike_style" required>
                                    <option value="">---</option>
                                    <option>Sirius</option>
                                    <option>Lyra</option>
                                    <option>Midnight in Paris</option>
                                    <!--<option>Vanilla</option>-->
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="item">
                        <div class="u24Medium">Accessories you would like
                        <!--<br><span style="font-size: 12px;color: #666;line-height: 16px;display: inline-block;">Easter gifts: kickstand, Micro Fender, water bottle cage will sent to you automatically, will not show in your jobrad offer (Ends on 25th of April)</span>-->
                        </div>
                        <input type="text" name="accessories" placeholder="Example: Extra-Comfort Saddle, Battery" >
                    </div>
                    <div class="item">
                        <div class="checkbox">
                            <input type="checkbox" id="subscribe" name="subscribe" value="subscribe" required />
                            <label class="u17Light" for="subscribe">I agree to allow Urtopia to store and process my
                                personal data.<i>*</i></label>
                        </div>
                    </div>
                    <div class="item">
                        <div style="display: flex;">
                            <button class="my-button my-button-black" type="submit">Submit</button>
                            <a class="my-button my-button-white" href="/pages/contactus">Contact us</a>
                        </div>
                    </div>
                    <!-- <div class="item u17Medium">Thank you for submitting the form. <br>Our expert will contact you soon.</div> -->
                </form>
            </div>
        </div>
        <div class="faqs">
            <div class="centeral-content">
                <div class="faq">
                    <div class="titlee">Frequently asked <br class="pcHide">questions about Mein-dienstrad</div>
                    <div class="swiper swiper-no-swiping faq-list">
                        <div class="swiper-wrapper">
                            <div class="swiper-slide">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

<script>
  window.addEventListener(
        'message',
        (function () {
            // NOTE: This is how we can support multiple instances in same page.
            var id = 'jobrad-fachhandel-werbematerial-werkzeugkasten-iframe-main'

            console.log('message');

            return function (event) {
                if (
                    id === 'jobrad-fachhandel-werbematerial-werkzeugkasten-iframe-main' &&
                    event.origin === 'https://bike-leasing-calculator.jobrad.org' &&
                    typeof event.data === 'object' &&
                    'genericState' in event.data &&
                    event.data.genericState.body.outerHeightInPixel > 0
                )
                    window.document.querySelector(
                        '.jobrad-bike-leasing-calculator#jobrad-fachhandel-werbematerial-werkzeugkasten-iframe-main iframe'
                    ).style.height =
                        event.data.genericState.body.outerHeightInPixel + 'px'
            }
        })(),
        false
    )

    const faqs = [
        {
            title: "Am I qualified for Mein Dienstrad?",
            content: `You are an employee: If your company already works with Mein Dienstrad, you can order your Urtopia today. If not, you can introduce your employer to Mein Dienstrad. You are self-employed: You can certainly lease one or more Urtopias for your company via Mein Dienstrad. You can find more practical information here .`
        },
        {
            title: 'What is the benefit of leasing a Urtopia through Mein Dienstrad?',
            content: 'With a leasing contract for company bikes, you save up to 40% of the original purchase price with full damage protection. In the case of an employer subsidy, you benefit even more! You conveniently pay the usage rates with your payslip and enjoy substantial net savings. Our all-round carefree package already includes fully comprehensive insurance, as well as the assumption of costs for all wearing parts, repairs and inspections. 100% digital - and still 100% personal! Your ordering process runs completely online via our portal www.mein-dienstrad.de. Here you can view the status of your order, save and manage important documents. You also have access to your data at any time - GDPR-compliant, of course.'
        },
        {
            title: 'How would the eSIM service working on leasing e-bike?',
            content: 'The first year is free. To avoid not being able to use some advanced features after one year, it is recommended to add 2 years of eSIM service on Jobrad. Outdoor 4G connectivity requires an active eSIM service to ensure constant connectivity and security on the go. It is required for many advanced smart features such as activity tracking, AI voice control, motion alerts, and OTA updates.'
        },
        {
            title: 'How do I order a Urtopia via Mein Dienstrad?',
            content: "Please fill out this form with your contact details to request a quote. We will then post an offer for you on the Mein Dienstrad portal: www.mein-dienstrad.de,. You can view the offer and view the status of your order, save and manage important documents. After confirmation, the offer is converted into an order. Your employer and Mein Dienstrad must approve the order. You will receive a confirmation email once your order has been reviewed and approved. Soon you’ll be riding your Urtopia bike!"
        }
    ]

    $('.faqs .swiper-slide').html(faqs.map(faq => `
      <div class="faq-item">
         <div class="faq-title">
           <span>${faq.title}</span>
           <i class="faq-content-plus"></i>
         </div>
         <div class="faq-content">${faq.content}</div>
      </div>`).join(''))


    setTimeout(() => {
        $('.faq-title').click(function () {
            $(this)
                .siblings('.faq-content')
                .slideToggle()
                .parent()
                .siblings()
                .find('.faq-content')
                .slideUp();
            $(this).children('i').toggleClass('faq-content-plus');
            $(this)
                .parent()
                .siblings()
                .find('.faq-title')
                .children('i')
                .addClass('faq-content-plus');
        });

        const forms = {}
        const ignore = ['submit', 'checkbox']

        function submit(extras = {}) {
            console.log('extras', extras)

            let search = {}
            const url = new URL(location.href)

            for (const [k, v] of url.searchParams.entries()) {
                search[k] = v
            }

            search = Object.assign(search, extras)

            // 重写bike_size
            search.bike_size = search.bike_size === 'M' ? 'M - Fit for 170-185 cm' : 'L - Fit for 180-195 cm'

            fetchBuried('mein-dienstrad', 'submit', search)
            // fbq('track', 'Jobrad Submit')
            fbq('track', 'CompleteRegistration', {
                value: 3596,
                currency: 'usd',
            });
        }


        let is_request = false
        $('.forms form :input').on('input', debounce(e => {
            if (is_request) {
                return            
            }

            is_request = true
            const data = {}

            $('.forms form :input').each((i, target) => {
                data[target.name] = target.value
            })

            fetchBuried('mein-dienstrad', 'submitinfo', data)
        }, 5000))

        $('.forms form').on("submit", function (event) {
            $('.forms form :input').each((index, target) => {
                if (ignore.includes(target.type)) {
                    return
                }



                forms[target.name] = target.value
            })

            // 隐藏form
            $('.forms form').hide()
            $('.forms .centeral-content').html(`
                <div class="u48DemiBold">Thank you!</div>
                <div class="u24Medium">You have successfully submit the form. Our expert will contact you soon. Feel free to contact us if you have any questions.</div>
                <a class="my-button my-button-white" href="/pages/contactus">Contact us</a>
            `)

            setTimeout(() => {
                $('html').animate({
                    scrollTop: $('.forms').offset().top - (document.documentElement.clientHeight / 2) + ($('.forms').height() / 2)
                }, 300)

                submit(forms)
            })

            event.preventDefault();
            return false;
        })
    }, 1000)


    if (!sessionStorage.isPreviewJobrad) {
        fetchBuried('mein-dienstrad', 'pageview')
    }

    // 记录来过这个页面
    sessionStorage.isPreviewJobrad = 'isPreviewJobrad'


    // url 处理
    const urlSearch = {}
    const urlInstance = new URL(location.href)

    for (const [k, v] of urlInstance.searchParams.entries()) {
        urlSearch[k] = v
    }

    // 如果bike_style 存在
    if (urlSearch.bike_style) {
        $(`select[name="bike_style"]`).val(urlSearch.bike_style)
    }

    // 如果bike_size 存在
    if (urlSearch.bike_size) {
        $(`select[name="bike_size"]`).val(urlSearch.bike_size)
    }

    // 如果有 accessories 存在
    if (urlSearch.accessories) {
        $(`input[name="accessories"]`).val(urlSearch.accessories)
    }

    


    $('.works .your').on('click', e => {
        const item = document.querySelector('.faqs .faq-item')
        const title = item.querySelector('.faq-title')
        const content = item.querySelector('.faq-content')

        // 如果是隐藏状态才展开
        if (window.getComputedStyle(content).display === 'none') {
            title.click()
        }
        
        console.log('e', e)
        setTimeout(() => {
            $('html').animate({
                scrollTop: $('.faqs').offset().top - 100
            }, 300)
        })


        e.preventDefault();
        return false;
    })
</script>