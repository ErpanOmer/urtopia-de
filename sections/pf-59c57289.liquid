{% assign random = "now" | date: "%L" | modulo: 2 %}

<script>
  const abtest_type = '{% if random == 0 %}A{% else %}B{% endif %}'

  if (!window.sessionStorage.ebikePageVisited) {
    window.sessionStorage.ebikePageVisited = 'ebikePageVisited'

    fetchBuried('a-b-test', 'carbon-ebikepage', {
        action_type: abtest_type,
        event_name: 'page view'
    })
  }

</script>

{% if random == 0 %}
  {% render 'carbon-ebike-page-a' %}
{% else %}
  {% render 'carbon-ebike-page-b' %}
{% endif %}

<script>
  $('[action_type]').on('click', e => {

    // 如果点击过 就别再统计
    if (!window.sessionStorage.ebikePageButtonClicked) {
      const action_type = $(e.target).attr('action_type')

      window.sessionStorage.ebikePageButtonClicked = 'ebikePageButtonClicked'

      fetchBuried('a-b-test', 'carbon-ebikepage', {
        action_type: abtest_type,
        event_name: 'button-click',
        button: action_type
      })
    }
  })
</script>