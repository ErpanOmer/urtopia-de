<!-- Cozy Country Redirect Optimization Code Start -->
{{ shop.metafields.CCR.shopat_script }}
<!-- Cozy Country Redirect Optimization Code Start -->

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-205871538-3"></script>
<script defer crossorigin="anonymous" src="https://connect.facebook.net/de_DE/sdk.js#xfbml=1&version=v14.0" nonce="nryZARoa"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2WKKVDX6JH"></script>
<!--outbrain tracking -->
<script data-obct type = "text/javascript">
  /** DO NOT MODIFY THIS CODE**/
  !function(_window, _document) {
    var OB_ADV_ID = '004724a1910ea66ba6f18eea401c197373';
    if (_window.obApi) {
      var toArray = function(object) {
        return Object.prototype.toString.call(object) === '[object Array]' ? object : [object];
      };
      _window.obApi.marketerId = toArray(_window.obApi.marketerId).concat(toArray(OB_ADV_ID));
      return;
    }
    var api = _window.obApi = function() {
      api.dispatch ? api.dispatch.apply(api, arguments) : api.queue.push(arguments);
    };
    api.version = '1.1';
    api.loaded = true;
    api.marketerId = OB_ADV_ID;
    api.queue = [];
    var tag = _document.createElement('script');
    tag.async = true;
    tag.src = '//amplify.outbrain.com/cp/obtp.js';
    tag.type = 'text/javascript';
    var script = _document.getElementsByTagName('script')[0];
    script.parentNode.insertBefore(tag, script);
  }(window, document);

  obApi('track', 'PAGE_VIEW');
</script>
    <!--outbrain tracking -->


<div class="selectLangModal" id="selectLangModal">
  <div class="selectLangContainer">
    <span class="close" onclick="goToPage(9)">✕</span>
    <h2>Select Your Language</h2>
    <p>Would you like to Select a language that you’re more comfortable with?</p>
    <div class="bottomButton">
      <div class="selectContainer" onclick="setLangOpen()">
        <div class="selectBox">
          <span id="curentLang" data_code="en">English</span>
        </div>
        <ul class="downSelectBox">
          <li
            data-code="en"
            data-value="English"
            onclick="updateLang(this)"
          >
            English
          </li>
          <li data-code="de" data-value="German" onclick="updateLang(this)">German</li>
          <li data-code="fr" data-value="French" onclick="updateLang(this)">French</li>
        </ul>
      </div>
      <button type="button" onclick="goToPage()">Select</button>
    </div>
  </div>
</div>

<div class="message-box mobileHide">
  <img
    src="https://cdn.shopify.com/s/files/1/0633/2068/6808/files/jobradorg_2x_9fa9518f-0618-4ba0-8973-8f5a381f940d.png?v=1680154687"
    alt=""
  >
  <div>
    <div class="u17Medium">Save up to 40%</div>
    <div style="margin: 6px 0 24px;">Lease a Urtopia with JobRad and save up to 40%.</div>
    <a class="my-button my-button-black" onclick="hideLayerSide()" href="/pages/jobrad">Learn more</a>
  </div>
  <span onclick="hideLayerSide()">×</span>
</div>
<div class="message-box message-box-mobile pcHide">
  <div>
    <div class="u17Medium">Save up to 40%</div>
    <div style="margin: 6px 0 12px;">Lease a Urtopia with JobRad and save up to 40%.</div>
    <a class="my-button my-button-black" onclick="hideLayerSide()" href="/pages/jobrad">Learn more</a>
  </div>
  <img
    src="https://cdn.shopify.com/s/files/1/0633/2068/6808/files/jobradorg_2x_9fa9518f-0618-4ba0-8973-8f5a381f940d.png?v=1680154687"
    alt=""
  >
  <span onclick="hideLayerSide()">×</span>
</div>


<style>
  .subscribe-container {
      display: grid;
      max-width: 976px;
      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
      border-radius: 10px;
      background-color: transparent;
  }
  
  .subscribe-container .subscribe {
      display: flex;
      flex-direction: column;
      padding: 12%;
      justify-content: center;
      background-color: #fff;
  }
  
  .subscribe-container .subscribe img {
      margin: 30px 0;
      max-width: 265px;
  }
  
  .subscribe-container .subscribe .u17Light {
      line-height: 24px;
      margin-bottom: 86px;
  }
  
  .subscribe-container .subscribe .email {
      box-sizing: border-box;
      display: flex;
      height: 47px;
      position: relative;
  }
  
  .subscribe-container .subscribe .email input {
      height: 100%;
      width: 100%;
      border-color: #0000004d;
      border-radius: 30px;
      color: #000;
      padding: 0 25px;
      font-size: 14px;
      position: relative;
      z-index: 1;
      overflow: hidden;
      box-sizing: border-box;
  }

  .subscribe-container .subscribe .email button {
    border: none;
}

  .subscribe-container .subscribe .email input:focus-visible {
    border-color: #000;
  }
  
  .subscribe-container .subscribe .email .my-button {
      position: absolute;
      right: 0;
      z-index: 2;
      height: 100%;
      border-top-left-radius: 0;
      border-bottom-left-radius: 0;
  }
  
  .subscribe-container .subscribe .email input::placeholder {
      color: #aaa;
  }
  
  .subscribe-container .close {
    position: absolute;
    top: 10px;
    right: 10px;
    font-size: 40px;
    color: #999;
    cursor: pointer;
    font-weight: 100;
    display: block;
    height: 40px;
    line-height: 40px;
    width: 40px;
    text-align: center;
  }
  
  @media (max-width: 767px) {
      .subscribe-container {
          grid-template-columns: 1fr;
      }
  
      .subscribe-container .subscribe {
          padding: 8%;
      }
  
      .subscribe-container .subscribe .u20Medium {
          font-size: 18px;
          line-height: 21px;
      }
  
      .subscribe-container .subscribe img {
          margin: 15px 0;
          max-width: 205px;
      }
  
      .subscribe-container .subscribe .u17Light {
          font-size: 15px;
          line-height: 21px;
          margin-bottom: 40px;
      }
  
      .subscribe-container .subscribe .email {
          height: 40px;   
      }
  
      .subscribe-container .subscribe .email input {
          font-size: 12px;
          padding: 0 15px;
      }
  
      .subscribe-container .close {
          color: #fff;
          top: 0.5%;
          right: 1%;
      }
  }
  </style>

<style>
  .message-box {
    width: 367px;
    height: auto;
    position: fixed;
    right: -367px;
    transition: all 0.3s;
    padding: 0 0 25px 25px;
    background-color: #eff1f8;
    display: grid;
    grid-template-columns: 1fr 1.5fr;
    grid-column-gap: 15px;
    align-items: center;
    border-radius: 10px;
    bottom: 70px;
    z-index: 1000000;
  }

  .message-box div {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: flex-start;
    font-size: 12px;
    line-height: 16.8px;
    padding-right: 18px;
  }

  .message-box div .u17Medium {
    font-size: 18px;
    line-height: 22.5px;
    font-weight: 600;
    margin-top: 45px;
  }

  .message-box span {
    position: absolute;
    right: 15px;
    top: -5px;
    font-size: 30px;
    color: #999;
    cursor: pointer;
  }

  @media (max-width: 767px) {
    .message-box-mobile {
      width: 100%;
      bottom: -180px;
      right: 0 !important;
      align-items: flex-end;
      padding: 25px 30px;
      grid-template-columns: 2fr 1fr;
      border-bottom-left-radius: 0;
      border-bottom-right-radius: 0;
    }

    .message-box-mobile div {
      padding: 0;
    }

    .message-box-mobile img {
      max-width: 80px;
    }

    .message-box-mobile div .u17Medium {
      margin: 0;
      font-size: 16px;
    }

    .message-box-mobile span {
      top: 5px;
      right: 15px;
    }
  }
</style>

<style>
  .selectLangModal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: #000000b3;
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 999;
  }
  .selectLangModal.open {
    display: flex;
  }
  .selectLangContainer {
    width: 80%;
    max-width: 700px;
    aspect-ratio: 700/350;
    border-radius: 10px;
    background-color: white;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    position: relative;
  }

  .selectLangContainer .close {
    position: absolute;
    right: 25px;
    top: 10px;
    font-size: 24px;
    cursor: pointer;
  }

  .selectLangContainer h2 {
    margin: 0 0 20px 0px;
    font: normal normal 600 24px/28px urbane;
  }
  .selectLangContainer p {
    max-width: 358px;
    text-align: center;
    font: normal normal 300 17px/24px urbane;
  }
  .selectContainer {
    position: relative;
    margin-right: 10px;
  }
  .selectContainer .selectBox {
    width: 224px;
    height: 47px;
    padding: 0 25px;
    font: normal normal 500 16px/19px urbane;
    line-height: 47px;
    border-radius: 30px;
    border: 1px solid black;
    cursor: pointer;
    display: flex;
    align-items: center;
  }
  .selectLangContainer button {
    padding: 16px 30px;
    height: 47px;
    border-radius: 30px;
    background-color: #000;
    color: #fff;
    border: none;
    cursor: pointer;
  }
  .downSelectBox {
    position: absolute;
    top: 60px;
    left: 0;
    margin: 0;
    padding: 0;
    background-color: #fff;
    box-shadow: 0px 0px 10px #00000019;
    border-radius: 12px;
    width: 100%;
    display: none;
  }
  .downSelectBox li {
    list-style-type: none;
    padding: 13px;
    cursor: pointer;
  }
  .bottomButton {
    margin-top: 60px;
    display: flex;
  }
  .selectBox::after {
    content: '';
    display: inline-block;
    width: 7px;
    height: 7px;
    margin: 0 5px 0 auto;
    border-width: 0 1px 1px 0;
    border-style: solid;
    border-color: #000;
    opacity: 0.9;
    transform: rotate(45deg) translate(0, -40%);
    transition: 0.3s ease;
  }
  .selectContainer.open .selectBox::after {
    transform: rotate(-135deg) translate(-2px, 0);
  }
  .selectContainer.open .downSelectBox {
    display: block;
  }
  @media screen and (max-width: 768px) {
    .selectLangContainer {
      aspect-ratio: 305/278;
      padding: 0 16px;
    }
    .selectLangContainer h2 {
      font: normal normal 600 20px/24px urbane;
    }
    .selectLangContainer p {
      font: normal normal 300 15px/21px urbane;
    }
    .selectContainer .selectBox {
      width: 150px;
      height: 40px;
      padding: 0 16px;
      font: normal normal 500 14px/19px urbane;
    }
    .selectLangContainer button {
      padding: 0 16px;
      height: 40px;
    }
  }
</style>

<link rel="prefetch" href="https://cdn.shopify.com/s/files/1/0633/2068/6808/files/Urtopia_Photo_Sesh_14_of_14_2x_9ec4000c-c609-4829-b4a2-430a5b7aae63.jpg?v=1680259217" as="image">
<link rel="prefetch" href="https://cdn.shopify.com/s/files/1/0633/2068/6808/files/Urtopia_Photo_Sesh_9_of_14_2x_dc648c2b-067f-4357-bda8-d917f51fd883.jpg?v=1680259100" as="image">
<script>
  // 邮件订阅弹窗
  const subscribeHtml = `<div class="subscribe-container">
    <img class="mobileHide" src="https://cdn.shopify.com/s/files/1/0633/2068/6808/files/Urtopia_Photo_Sesh_14_of_14_2x_9ec4000c-c609-4829-b4a2-430a5b7aae63.jpg?v=1680259217" alt="">
    <img class="pcHide" src="https://cdn.shopify.com/s/files/1/0633/2068/6808/files/Urtopia_Photo_Sesh_9_of_14_2x_dc648c2b-067f-4357-bda8-d917f51fd883.jpg?v=1680259100" alt="">
    <div class="subscribe">
        <span class="u20Medium">Huge Easter Sale</span>
        <img src="https://cdn.shopify.com/s/files/1/0633/2068/6808/files/Union_2_2x_2ad80dcd-895b-4d97-92c5-0669622ad449.png?v=1680251686">
        <span class="u17Light">Subscribe for Easter exclusive coupon and Utopia stories</span>
        <form action="" method="post">
        <div class="email">
              <input placeholder="Enter email here" type="email" required>
              <button class="my-button my-button-black" type="submit">Subscribe</button>
        </div>
      </form>
    </div>
    <span class="close" onclick="closeMiniDialog()">×</span>
</div>D`
  
  
  class MyStorage {
    constructor(props) {
      this.props = props || {};
      this.source = this.props.source || window.localStorage;
      this.initrun();
    }
    initrun() {
      /*
       * set 存储方法
       * @ param {string} key 键
       * @ param {string} value 值，存储的值可能是数组/对象，不能直接存储，需要转换 json.stringify
       * @ param {string} expired 过期时间，以分钟为单位
       * @ 由@it·平头哥联盟-首席填坑官∙苏南 分享
       */
      const reg = new RegExp('__expires__');
      let data = this.source;
      let list = Object.keys(data);
      if (list.length > 0) {
        list.map((key, v) => {
          if (!reg.test(key)) {
            let now = Date.now();
            let expires = data[`${key}__expires__`] || Date.now() + 1;
            if (now >= expires) {
              this.remove(key);
            }
          }
          return key;
        });
      }
    }

    set(key, value, expired = 3) {
      /*
      * set 存储方法
      * @ param {string} key 键
      * @ param {string} value 值，
      * @ param {string} expired 过期时间，以分钟为单位，非必须
      * @ 由@it·平头哥联盟-首席填坑官∙苏南 分享
      */
      let source = this.source;
      source[key] = JSON.stringify(value);
      if (expired){
      source[`${key}__expires__`] = Date.now() + 1000 * 60 * 60 * 24 * expired
      };
      return value;
     }

    get(key) {
      /*
      * get 获取方法
      * @ param {string} key 键
      * @ param {string} expired 存储时为非必须字段，所以有可能取不到，默认为 date.now+1
      * @ 由@it·平头哥联盟-首席填坑官∙苏南 分享
      */
      const source = this.source,
      expired = source[`${key}__expires__`]||Date.now()+1;
      const now = Date.now();
      
      if ( now >= expired ) {
      this.remove(key);
      return;
      }
      const value = source[key] ? JSON.parse(source[key]) : source[key];
      return value;
     }

    remove(key) {
      const data = this.source,
      value = data[key];
      delete data[key];
      delete data[`${key}__expires__`];
      return value;
     }
  }


  const storage = new MyStorage()
  const options = document.querySelectorAll('.tl-options .tl-option')

  // 监听页面语言插件切换
  options.forEach((v) => {
    v.addEventListener('click', () => {
      let val = v.getAttribute('data-value');
      storage.set('selectLang', val)
      sessionStorage.setItem('selectLang', val)
    });
  });

  function gotoLocation (code = 'de') {
    const parent = Array.from(document.querySelectorAll('.tl-options')).pop()
    const allOptions = Array.from(parent.querySelectorAll('.tl-option'))
    const active = allOptions.find(tl => Array.from(tl.classList).includes('active'))
    const findLang = allOptions.find(tl => tl.dataset.value === code)

    if (active.dataset.value === code) {
      return setTimeout(showMiniDialog, 5000, subscribeHtml)
    }

    setTimeout(() => {
      findLang.dispatchEvent(new Event('click'))
    }, 0)
  }

  const langmap = {
    en: {
      code: 'en',
      value: 'English',
    },
    de: {
      code: 'de',
      value: 'German',
    },
    fr: {
      code: 'fr',
      value: 'French',
    },
  };
  window.onload = () => {

    console.log('加载了');
    let langCode = window.CozyCountryRedirect.country;
    let locale = window.Shopify.locale;

    {% comment %} let langCookie = storage.get('selectLang') || '' {% endcomment %}
    let langCookie = sessionStorage.getItem('selectLang') || ''
    

    console.log('当前国家', langCode, '当前语言', locale, 'langCookie', langCookie);
    // 是否选择语言
    if (langCookie) {
      gotoLocation(langCookie)
    } else {
      let notShowModal =
        (langCode === 'de' && locale === 'de') ||
        (langCode === 'fr' && locale === 'fr') ||
        (langCode !== 'de' && langCode !== 'fr' && locale === 'en');

      let recommendCode = langmap[langCode]?.code || 'en';
      let recommendVal = langmap[langCode]?.value || 'English';
      document.querySelector('#curentLang').setAttribute('data_code', recommendCode);
      document.querySelector('#curentLang').innerText = recommendVal;

      if (!notShowModal && !window.__SHOPIFY_CLI_ENV__ && !sessionStorage.getItem('selectLangDialog')) {
        document.querySelector('#selectLangModal').classList.add('open');
      } else {
        setTimeout(showMiniDialog, 5000, subscribeHtml)
      }
    }


    setTimeout(showLayerSide, 10000)
  };
  const updateLang = (el) => {
    let code = el.getAttribute('data-code');
    let val = el.getAttribute('data-value');

    document.querySelector('#curentLang').setAttribute('data_code', code);
    document.querySelector('#curentLang').innerText = val;
  };

  const setLangOpen = () => {
    if (document.querySelector('.selectContainer').classList.value.indexOf('open') !== -1) {
      document.querySelector('.selectContainer').classList.remove('open');
    } else {
      document.querySelector('.selectContainer').classList.add('open');
    }
  };

  const goToPage = isClose => {
    let currCode = document.querySelector('#curentLang').getAttribute('data_code');

    document.querySelector('#selectLangModal').classList.remove('open');
    sessionStorage.setItem('selectLangDialog', 'selectLangDialog')
    // 如果是单纯的关闭，直接退出去
    if (isClose) {
      return setTimeout(showMiniDialog, 5000, subscribeHtml)
    }

    var d = new Date();
    d.setTime(d.getTime() + 3 * 24 * 60 * 60 * 1000); // 3天后到期
    var expires = d.toGMTString();
    {% comment %} delCookie('selectLang');

    setTimeout(() => {
      document.cookie = `selectLang=${currCode};expires=${expires};path=/`;
    }, 300); {% endcomment %}

    storage.set('selectLang', currCode)
    sessionStorage.setItem('selectLang', currCode)
    
    
    gotoLocation(currCode)

    console.log('currCode', currCode);
  };

  function getCookie(cname) {
    var name = cname + '=';
    var ca = document.cookie.split(';');
    for (var i = 0; i < ca.length; i++) {
      var c = ca[i].trim();
      if (c.indexOf(name) == 0) return c.substring(name.length, c.length);
    }
    return '';
  }

  function delCookie(name) {
    var exp = new Date();
    exp.setTime(exp.getTime() - 1);
    var cval = getCookie(name);
    if (cval != null) {
      document.cookie = name + '=' + cval + ';expires=Thu, 01 Jan 1970 00:00:00 UTC;path=/;';
    }
  }


  function hideLayerSide() {
    sessionStorage.setItem('jobradMessage', 'jobradMessage')

    $(".message-box").animate({}, 300, function () {
      //第一个花括号里面是动画内容，可以为空，但不能省去中括号
      $(".message-box").css({ "right": "-367px" }); //在回调函数里面改变css属性来实现transform中的动画变换
    })

    $(".message-box-mobile").animate({}, 300, function () {
      //第一个花括号里面是动画内容，可以为空，但不能省去中括号
      $(".message-box-mobile").css({ "bottom": "-180px" }); //在回调函数里面改变css属性来实现transform中的动画变换
    })
  }
  //展示div
  function showLayerSide() {

    if (sessionStorage.getItem('jobradMessage')) {
      return
    }


    $(".message-box").animate({}, 300, function () {
      //第一个花括号里面是动画内容，可以为空，但不能省去中括号
      $(".message-box").css({ "right": "18px" }); //在回调函数里面改变css属性来实现transform中的动画变换
    })

    $(".message-box-mobile").animate({}, 300, function () {
      //第一个花括号里面是动画内容，可以为空，但不能省去中括号
      $(".message-box-mobile").css({ "bottom": "0" }); //在回调函数里面改变css属性来实现transform中的动画变换
    })
  }


  function showMiniDialog(html = '') {
    if (storage.get('emailDialogHideDay')) {
      return
    }
 
    $('body .mini-dialog').remove()
    setTimeout(() => {
      $("body").append(`<div class="mini-dialog" style="display: flex;">${html}</div>`)

      {% comment %} setTimeout(() => {
        $('body .mini-dialog > div').on('click', e => {
          e.stopPropagation();
          return false;
        })
      }, 100) {% endcomment %}


      setTimeout(() => {
          $('.subscribe-container form').on("submit", function (event) {
            const email = $('.subscribe-container form input[type="email"]').val()
            console.log('email', email)

          const formData = new FormData()
          formData.append('form_type', 'customer')
          formData.append('contact[tags]', 'newsletter')
          formData.append('contact[email]', email)
          formData.append('commit', '')

          console.log('formData', formData)



          fetch("/contact", {
              method: "POST",
              headers: {
                "Content-Type": "application/x-www-form-urlencoded",
              },
              body: formData
          })

          closeMiniDialog(3)

        
            event.preventDefault();
            return false;
        })
      }, 1000)
    })
  }

  function closeMiniDialog(day = 14) {
    // console.log(a === document.querySelector('body .mini-dialog'))
    $('body .mini-dialog').remove()


    storage.set('emailDialogHideDay', 'emailDialogHideDay', day)
  }

</script>

<script type="text/javascript">"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function loadFlatPicker(){return jQuery('<link href="https://a.mailmunch.co/assets/stylesheets/flatpickr/flatpickr.min.css" rel="stylesheet">').appendTo("head"),jQuery.getScript("https://a.mailmunch.co/assets/javascripts/flatpickr/flatpickr.js")}function loadPlugins(e){if(e)return jQuery('<link href="https://a.mailmunch.co/assets/stylesheets/flatpickr/monthselect.css" rel="stylesheet">').appendTo("head"),jQuery.getScript("https://a.mailmunch.co/assets/javascripts/flatpickr/monthselect.js")}function initDatePicker(){if(0!=jQuery("form.new-contact .input-field[data-type=date]").length){var i=!1;jQuery("form.new-contact .input-field[data-type=date]").each(function(e,t){if(!jQuery(t).data("date-format").includes("DD"))return!(i=!0)}),jQuery.when(loadFlatPicker(),loadPlugins(i),jQuery.Deferred(function(e){jQuery(e.resolve)})).done(function(){jQuery("form.new-contact .input-field[data-type=date]").each(function(e,t){var i=jQuery(t).data("date-format"),r=i.includes("-")?"-":"/",n=i.split(/[/-]+/).map(function(e){switch(e){case"MM":return"m";case"DD":return"d";case"YYYY":return"Y";case"YY":return"y";default:return e}}).join(r),a=jQuery(t).find("input[type=text]");a.mask(i.replace(/[A-Z]/g,"9"),{placeholder:i}),i.includes("DD")?flatpickr(a,{disableMobile:"true",dateFormat:n,allowInput:!0}):flatpickr(a,{disableMobile:"true",allowInput:!0,plugins:[new monthSelectPlugin({dateFormat:n})]})})})}}function isColorDarkOrLight(e){var t,i,r;return e.match(/^rgb/)?(t=(e=e.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)$/))[1],i=e[2],r=e[3]):(t=(e=+("0x"+e.slice(1).replace(e.length<5&&/./g,"$&$&")))>>16,i=e>>8&255,r=255&e),127.5<Math.sqrt(t*t*.299+i*i*.587+r*r*.114)?"light":"dark"}function validateRecipient(e,r){e.hideError();var n="undefined"!=typeof widgetId?widgetId:"undefined"!=typeof documentId?documentId:null,a="undefined"!=typeof widgetId?"widget":"undefined"!=typeof documentId?"document":null,s="development"===environment?"http":"https";return new Promise(function(t,i){n&&a?jQuery.ajax({url:s+"://"+formsDomain+"/form/"+siteId+"/"+n+"/verify_email/"+r,method:"GET",dataType:"json",data:{resourceType:a},success:function(e){t(e)},error:function(e){i(e)}}):i("resourceId and resourceType are not present")})}function addDidYouMeanContent(e,t){var i=e.emailSlug,r=e.input[0].form.querySelector("#didYouMeanContent-"+i),n=[],a=" "+t+"?";r&&(n=r.getElementsByTagName("span")[0]);r?n.textContent=a:((r=document.createElement("div")).id="didYouMeanContent-"+i,r.style.color="#AA4442",r.style.marginTop="6px",r.style.position="relative",r.textContent="Did you mean",(n=document.createElement("span")).style.color="#6387F9",n.style.cursor="pointer",n.textContent=a,r.appendChild(n),e.input.parent().after(r)),window.frameElement&&window.resizeWidget(),n.onclick=function(){e.input.val(t),removeDidYouMeanContent(e),e.hideError()}}function checkLeadQualityPermissions(e){var t=!1;return e&&Object.values(e).forEach(function(e){e&&(t=!0)}),t}function checkGlobalLeadQualityPermission(){try{if(window.parent._mmunch.leadQuality)return!0}catch(e){}return!1}function validateEmailTypes(e,t){var i=!0,r="";return e.reject_disposable&&t.response.is_disposable?(i=!1,r="Disposable emails are not allowed."):e.reject_free_services&&t.response.is_free?(i=!1,r="Email address from this service is not allowed."):e.reject_role_based&&t.response.is_role&&(i=!1,r="This does not look like a personal email."),{valid:i,errorMessage:r}}function initializeLoading(e){var t=e.emailSlug,i="#000000";"dark"===isColorDarkOrLight(e.input[0].style["background-color"])&&(i="#FFFFFF");var r="emailFieldLoader-"+t;e.input.after("<div         id="+r+'        style="position: absolute; top: calc(50% - 21px); right: 18px"         class="lds-ring">           <div style="border-color: '+i+' transparent transparent transparent;"></div>           <div style="border-color: '+i+' transparent transparent transparent;"></div>           <div style="border-color: '+i+' transparent transparent transparent;"></div>           <div style="border-color: '+i+' transparent transparent transparent;"></div>       </div>')}function terminateLoading(e){var t=e.emailSlug,i=document.querySelector("#emailFieldLoader-"+t);i&&i.remove()}function removeDidYouMeanContent(e){var t=e.emailSlug;e.input[0].form.querySelector("#didYouMeanContent-"+t).remove()}function checkDidYouMeanContentUniqueness(e,t){var i=!0,r=e.input[0].form.querySelector("#didYouMeanContent-"+e.emailSlug);if(r){var n=r.getElementsByTagName("span")[0].textContent.split(/[ ?]/);n&&n.length&&n[1]&&n[1]===t.response.did_you_mean&&(i=!1)}return i}function updateSubmitButton(e,t){e[0].disabled=t,e[0]["pointer-events"]=t?"none":"auto",e[0].style.cursor=t?"not-allowed":"pointer"}var _createClass=function(){function r(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,i){return t&&r(e.prototype,t),i&&r(e,i),e}}(),_get=function get(e,t,i){for(var r=!0;r;){var n=e,a=t,s=i;r=!1,null===n&&(n=Function.prototype);var o=Object.getOwnPropertyDescriptor(n,a);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(s)}var u=Object.getPrototypeOf(n);if(null===u)return undefined;e=u,t=a,i=s,r=!0,o=u=undefined}},Field=function(){function t(e){_classCallCheck(this,t),this.field=e,this.required=e.data("required"),this.type=e.data("type"),this.label=e.data("label"),this.name=e.data("name"),this.input=0<e.find("textarea").length?e.find("textarea"):e.find("input"),this.select=e.find("select"),this.error=e.find(".field-error")}return _createClass(t,[{key:"showError",value:function i(e){this.error.html(e).show(),this.field.addClass("error-field")}},{key:"hideError",value:function e(){this.error.hide(),this.field.removeClass("error-field")}},{key:"isValidText",value:function r(e){return 0!=jQuery.trim(e).length}},{key:"isValidNumber",value:function n(e){return jQuery.isNumeric(e)}},{key:"isValidEmail",value:function a(e){return!!/^([a-zA-Z0-9_.+-`\xe2\u20ac\u2122'])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(e)}},{key:"isValidCheckbox",value:function s(e){return 0<e.find("input:checked").length}},{key:"isValidDate",value:function h(e,t){var i=-1==e.indexOf("-")?"/":"-",r=e.split(i);if(r.length!=t.split(i).length)return!1;var n=t.split(i),a=n.indexOf("DD"),s=n.indexOf("MM");if(-1<n.indexOf("YYYY"))var o=n.indexOf("YYYY");else o=n.indexOf("YY");var l=-1<a?r[a]:"01",u=-1<s?r[s]:"01",d=-1<o?"20"+r[o]:"2016",c=new Date(d+"/"+u+"/"+l);return c&&c.getMonth()+1==Number(u)&&c.getDate()==Number(l)&&c.getFullYear()==Number(d)}}]),t}(),formsDomain="forms.mailmunch.co",environment="production",EmailField=function(){function i(e){_classCallCheck(this,i),jQuery("<style>         .lds-ring {           display: inline-block;           position: relative;           width: 25px;           height: 25px;         }         .lds-ring div {           box-sizing: border-box;           display: block;           position: absolute;           width: 25px;           height: 25px;           margin: 8px;           border: 2px solid #cef;           border-radius: 50%;           animation: lds-ring 1.2s cubic-bezier(0.5, 0, 0.5, 1) infinite;         }         .lds-ring div:nth-child(1) {           animation-delay: -0.45s;         }         .lds-ring div:nth-child(2) {           animation-delay: -0.3s;         }         .lds-ring div:nth-child(3) {           animation-delay: -0.15s;         }         @keyframes lds-ring {           0% {             transform: rotate(0deg);           }           100% {             transform: rotate(360deg);           }         }       </style>").appendTo("head"),_get(Object.getPrototypeOf(i.prototype),"constructor",this).call(this,e);var t=this;this.input.keyup(function(){t.hideError()}),this.emailSlug=this.input[0].name,this.isRateLimitExceeded=!1}return _inherits(i,Field),_createClass(i,[{key:"validate",value:function a(){var s=this,e=this.input.val(),t=this.isValidText(e),i=this.isValidEmail(e),o=!0;if(this.required&&!t)return this.showError(this.label+" is required"),Promise.resolve(!1);if((this.required||0<e.length)&&!i)return this.showError(this.label+" is invalid"),Promise.resolve(!1);if(!this.required&&!e.length)return Promise.resolve(!0);var l="undefined"!=typeof leadQuality?leadQuality:{},r=checkGlobalLeadQualityPermission(),n=checkLeadQualityPermissions(l);return!this.isRateLimitExceeded&&r&&n?new Promise(function(n,a){initializeLoading(s),validateRecipient(s,e).then(function(e){if(terminateLoading(s),e.success){var t=l.correct_typos&&e.response&&e.response.did_you_mean||!1;if(t&&(o=checkDidYouMeanContentUniqueness(s,e),addDidYouMeanContent(s,e.response.did_you_mean)),e.response&&e.response.valid){var i=validateEmailTypes(l,e);t&&i.valid?n(!o):i.valid?n(!0):(s.showError(i.errorMessage),n(!1))}else{var r=" ("+(e.response.reason||"Invalid Email")+")";s.showError(s.label+r),n(!1)}}else s.showError("Email Error"),a(!1)})["catch"](function(e){terminateLoading(s),e&&429===e.status?(s.isRateLimitExceeded=!0,n(!0)):(s.showError("Email Error"),a(e))})}):Promise.resolve(!0)}},{key:"value",value:function e(){return this.input.val()}}]),i}(),TextField=function(){function i(e){_classCallCheck(this,i),_get(Object.getPrototypeOf(i.prototype),"constructor",this).call(this,e);var t=this;this.input.keyup(function(){t.hideError()})}return _inherits(i,Field),_createClass(i,[{key:"validate",value:function t(){if(!this.required)return!0;var e=this.isValidText(this.input.…</script>

{% schema %}
{
  "name": "Section name",
  "settings": []
}
{% endschema %}

{% stylesheet %}
{% endstylesheet %}

{% javascript %}
{% endjavascript %}
